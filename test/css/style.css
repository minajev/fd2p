/* ========== Root ========== */
:root{
  --bg:#ffffff;
  --ink:#111111;
  --muted:#6b7280;
  --line:#e5e7eb;
  --accent:#E30613;
  --accent-ink:#ffffff;
  --container:1440px;

  --headline-min: 22px;
  --headline-max: 44px;
  --meta-min: 12px;      /* tags & caption */
  --meta-max: 18px;

  /* Header geometry */
  --header-h:64px;
  --dock-w:500px;
  --dock-h:120px;     /* extra height below header */
  --bevel:120px;      /* top-right cut of the left panel */
  --logo-scale:1;     /* large logo scale */
}

html{
  scrollbar-gutter: stable both-edges;
}
/* Fallback for browsers without scrollbar-gutter support */
@supports not (scrollbar-gutter: stable) {
  html { overflow-y: scroll; } /* reserve scrollbar space to avoid layout shift */
}

/* ========== Base ========== */
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; color:var(--ink); background:var(--bg);
  font:16px/1.55 -apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans",sans-serif;
  -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
}
img{display:block; max-width:100%; height:auto}
.container{max-width:var(--container); margin:0 auto; padding:0 24px}

/* ========== Header shell ========== */
.site-header{
  position:sticky; top:0; z-index:100;
  height:var(--header-h);
  background:#fff;
  border-bottom:1px solid var(--line);
  overflow:visible;
}

/* Left beveled panel */
.logo-panel{
  position:absolute; left:0; top:0; z-index:0;
  width:var(--dock-w);
  height:calc(var(--header-h) + var(--dock-h));
  background:#fff;
  clip-path: url(#logoPanelClip);
  /* no shadow at all */
  filter:none;
  pointer-events:none;
  transition:height .45s ease, width .45s ease;
}

/* Unified header geometry (panel clip + progress lines) */
.header-geo{
  position:absolute; left:0; top:0; z-index:3;
  width:100%;
  height:calc(var(--header-h) + var(--dock-h));
  pointer-events:none;
  transition:height .45s ease, opacity .2s ease;
}

/* Red progress lines */
.progress-line{
  fill:none;
  stroke:var(--accent);
  stroke-width:4px;
  stroke-linecap:round;
  filter:drop-shadow(0 0 10px rgba(227,6,19,.25));
  vector-effect:non-scaling-stroke;
  shape-rendering:geometricPrecision;
}

/* Big docked logo (shown in open state) */
.brand-dock{
  position:absolute; left:80px; top:12px; z-index:1;
  transform-origin:top left;
  transform:scale(var(--logo-scale));
  transition:opacity .28s ease, visibility .28s ease, transform .45s ease;
}
.brand-dock img{
  height: calc(var(--header-h) + var(--dock-h) - 20px);
  width:auto;
  max-height:100%;
  min-height:96px;
  object-fit:contain;
}

/* Reveal the header's bottom border under the panel when collapsed */
body.is-collapsed .logo-panel{
  height: calc(var(--header-h) - 1px);
}

/* Compact header row (small brand + nav) */
/* Header row: deterministic layout */
.header-inner{
  position:relative;
  z-index:2;
  height:var(--header-h);
  display:flex;
  align-items:center;
  justify-content:flex-start; /* was space-between */
}

.brand{
  display:flex; align-items:center; gap:12px;
  text-decoration:none; color:inherit;
  white-space:nowrap; flex-wrap:nowrap;
  transition:opacity .28s ease, visibility .28s ease;
}
.brand img{height:32px; flex:0 0 auto}
.brand-text{font-weight:700}

/* --- Keep the small logo size constant --- */
.site-header .brand{
  flex: 0 0 auto;        /* don't let the brand block shrink */
  min-width: fit-content;
  white-space: nowrap;
}

.site-header .brand img{
  height: 32px;          /* fixed pixel height for the small logo */
  width: auto;           /* keep aspect ratio */
  max-width: none;       /* never cap by container width */
  flex: 0 0 auto;        /* don't shrink inside flex */
  object-fit: contain;   /* just in case */
}

/* Optional: a bit less side padding on ultra-narrow screens to avoid crowding */
@media (max-width: 420px){
  .container{ padding-left:16px; padding-right:16px; }
}

/* Nav sits at the far right when visible */
.main-nav{
  display:flex;
  align-items:center;
  gap:18px;
  margin-left:auto; /* new */
  transition:opacity .25s ease, visibility .25s ease; /* remove transform transition */
}
.main-nav a{
  padding:8px 10px; border-radius:10px;
  border:1px solid transparent; text-decoration:none;
  color:#1f2937; font-weight:600;
  position:relative; transition:color .18s ease, background-color .18s ease, transform .12s ease, border-color .18s ease;
}
.site-header .main-nav a:hover,
.site-header .main-nav a:focus-visible {
  color: #1f2937; /* keep default text color */
  background: #f9fafb;
  border-color: #e5e7eb;
  transform: translateY(-1px);
}
.site-header .main-nav a::after{
  content:""; position:absolute; left:50%; bottom:6px; width:60%; height:2px;
  background:var(--accent); border-radius:2px; opacity:.95;
  transform:translateX(-50%) scaleX(0); transform-origin:center; transition:transform .22s ease;
}
.site-header .main-nav a:hover::after,
.site-header .main-nav a:focus-visible::after,
.site-header .main-nav a[aria-current="page"]::after{transform:translateX(-50%) scaleX(1)}

/* Buttons */
.btn{display:inline-flex; align-items:center; justify-content:center; height:40px; padding:0 16px; border-radius:10px; border:1px solid transparent; text-decoration:none; font-weight:700; cursor:pointer}
.btn-outline{border-color:var(--line); color:#111}
.btn-outline-dark{border:1px solid rgba(0,0,0,.30)}
.btn-accent{background:var(--accent); color:var(--accent-ink)}
.overlay .btn.btn-accent{
  transition: color .18s ease, background-color .18s ease, transform .12s ease, box-shadow .18s ease;
}
.overlay .btn.btn-accent:hover,
.overlay .btn.btn-accent:focus-visible{
  transform: translateY(-1px);
  background: rgba(227,6,19,.95);
  box-shadow: 0 8px 18px rgba(0,0,0,.10);
}
.overlay .btn.btn-accent:active{
  transform: translateY(0);
  box-shadow: 0 4px 10px rgba(0,0,0,.08) inset;
}

/* ========== Header progress ========== */
.header-progress{
  position:absolute; left:0; top:0; z-index:3;
  width:100%;
  height:calc(var(--header-h) + var(--dock-h));
  pointer-events:none;
  transition:height .45s ease, opacity .2s ease;
}
.hp{
  fill:none; stroke:var(--accent); stroke-linecap:round;
  filter:drop-shadow(0 0 10px rgba(227,6,19,.25));
  stroke-dasharray:1000; stroke-dashoffset:1000;
  vector-effect: non-scaling-stroke;
  shape-rendering: geometricPrecision;
  stroke-width:4px;
}
.hp.is-running{animation:hpDash var(--progress-duration,5000ms) linear forwards}
@keyframes hpDash{to{stroke-dashoffset:0}}

/* ========== State drivers ========== */
/* Collapse (hide big dock panel, show small brand) */
body.is-collapsed{
  --dock-h:0px;
  --bevel:0px;
  --logo-scale:.42;
}
body.is-collapsed .header-progress{opacity:1}

/* Large docked logo: visible only when open */
body:not(.is-collapsed) .brand-dock{opacity:1; visibility:visible}
body.is-collapsed .brand-dock{opacity:0; visibility:hidden; transform:scale(.6)}

/* Small brand row: visible only when collapsed */
body:not(.is-collapsed) .site-header .brand{opacity:0; visibility:hidden; pointer-events:none}
body.is-collapsed .site-header .brand{opacity:1; visibility:visible; pointer-events:auto}

/* Hidden nav: keep it out of flow and pinned to the right (no left “jump”) */
body.is-nav-hidden .main-nav{
  position:absolute !important;
  top:0;
  right:0;
  height:var(--header-h);
  opacity:0 !important;
  visibility:hidden !important;
  pointer-events:none !important;
}

/* Show the Menu button in that moment */
body.is-nav-hidden .menu-toggle{
  display:inline-flex;
}
body.is-nav-hidden .site-header .brand{opacity:1; visibility:visible}

/* ========== Hero slider ========== */
.hero{position:relative; height:78vh; min-height:520px; overflow:hidden}
.slider{position:relative; height:100%}
.slides{position:relative; height:100%; display:flex; transition:transform .6s ease-in-out; will-change:transform}
.slide{position:relative; flex:0 0 100%; height:100%; overflow:hidden}
.slide .bg{
  position:absolute; inset:0; z-index:1;
  background-size:cover; background-repeat:no-repeat;
  background-position:50% calc(50% + var(--p,0px));
}
.slider,
.slider .slides{
  touch-action: pan-y; /* allow vertical scroll; block native horizontal pan */
}
.overlay{
  position:absolute; inset:0; z-index:2;
  display:flex; flex-direction:column; align-items:center; justify-content:center; gap:16px;
  padding:24px; pointer-events:none;
  background:linear-gradient(to top, rgba(0,0,0,.18), rgba(0,0,0,.08) 40%, rgba(0,0,0,0) 70%);
}
.hero-frame{
  pointer-events:auto; display:flex; align-items:center; justify-content:center;
  padding:22px 28px; border:1px solid rgba(255,255,255,.85); border-radius:16px;
  background:rgba(20,22,24,.34);
}

/* Let slider receive drags even when starting over the overlay text */
.hero .overlay{
  pointer-events: none;                /* overlay itself does not intercept pointer events */
}

/* Keep the big button clickable */
.hero .overlay .js-learn{
  pointer-events: auto;                /* re-enable interactions for the button only */
}

/* Make the text block non-interactive and non-selectable */
.hero .hero-frame,
.hero .hero-text,
.hero .hero-text .line{
  -webkit-user-select: none;           /* iOS/Safari */
  user-select: none;                   /* modern browsers */
  -webkit-touch-callout: none;         /* disable long-press menu on iOS */
}

/* (Optional) prevent accidental text cursor on double-click */
.hero .hero-text{
  cursor: default;
}


/* Collapsed look on small screens BEFORE JS runs (prevents flash on reload) */
@media (max-width: 1024px){
  body:not(.js-ready) .brand-dock{        /* big logo on the panel */
    opacity: 0; pointer-events: none;
  }
  body:not(.js-ready) .logo-panel{        /* lift panel by 1px to reveal header line */
    height: calc(var(--header-h) - 1px);
  }
  body:not(.js-ready) .header-geo{        /* hide red line layer until JS positions it */
    display: none;
  }
  body:not(.js-ready) .slider .arrow{     /* hide arrows like in collapsed state */
    opacity: 0; display: none !important; pointer-events: none;
  }
  body:not(.js-ready) .site-header{       /* show the 1px bottom line */
    border-bottom: 1px solid var(--line);
  }
  /* HIDE the full nav before JS runs (no flash of links/buttons) */
  body:not(.js-ready) .main-nav{
    position: absolute;
    right: 0; top: 0; height: var(--header-h);
    opacity: 0; visibility: hidden;
    pointer-events: none;
  }
  /* SHOW the burger button before JS sets is-nav-hidden */
  body:not(.js-ready) .menu-toggle{
    visibility: hidden;
  }
  /* Make the small brand visible in pre-collapsed look */
  body:not(.js-ready) .site-header .brand{
    opacity: 1; visibility: visible; pointer-events: auto;
  }
  /* And fully hide the big docked logo (not только opacity) */
  body:not(.js-ready) .brand-dock{
    visibility: hidden;
  }
}

/* Tags and caption scale too */
.line-tags,
.line-caption{
  font-size: clamp(var(--meta-min), 2.4vw, var(--meta-max));
  line-height: 1.3;
}

/* Frame padding & width adapt to viewport */
.hero-frame{
  /* tighter padding on phones, fuller on desktop */
  padding: clamp(12px, 2.0vw, 22px) clamp(16px, 2.6vw, 28px);
  /* prevent overspill and let the form actually get smaller */
  max-width: min(92vw, 720px);
}
/* Smoothly animate frame size as we re-measure on resize */
#hero-frame{
  transition: width .25s ease, height .25s ease, padding .20s ease;
  will-change: width, height;
}

/* Optional: slightly narrower on very small screens */
@media (max-width: 480px){
  .hero-frame{ max-width: 94vw; }
}

/* Helpful defaults for wrapping long words if content is wide */
.hero-frame .line{
  overflow-wrap: anywhere;
  hyphens: auto;
}

.hero-text{display:flex; flex-direction:column; align-items:center; gap:8px; text-align:center}
.line{color:#fff}

.line-headline{font-weight:800; font-size:44px; line-height:1.12; text-shadow:0 1px 2px rgba(0,0,0,.45), 0 0 1px rgba(0,0,0,.35);
font-size: clamp(var(--headline-min), 4.2vw, var(--headline-max));
line-height: 1.1;
}



.line-tags{font-weight:800; font-size:13px; letter-spacing:.36px; text-transform:uppercase; white-space:nowrap; opacity:.95}
.line-caption{font-weight:800; font-size:20px; opacity:.98; text-shadow:0 1px 2px rgba(0,0,0,.40)}
.overlay .js-learn{pointer-events:auto; height:52px; padding:0 26px; font-size:17px; border-radius:12px}
/* Responsive sizing for the LEARN MORE button */
.hero .js-learn{
  /* gets smaller on narrow screens, capped on desktops */
  font-size: clamp(14px, 1.8vw, 16px);
  line-height: 1.2;

  /* scale padding with viewport; stays comfy on mobile */
  padding: clamp(8px, 1.4vw, 12px) clamp(14px, 2.4vw, 20px);

  /* optional: keep the outline thickness proportional */
  border-width: clamp(1px, 0.25vw, 2px);
}

/* (Optional) make it a touch smaller on very narrow phones */
@media (max-width: 420px){
  .hero .js-learn{
    font-size: 12px;
    padding: 8px 12px;
  }
}

/* Arrows */
.arrow{
  position:absolute; top:50%; transform:translateY(-50%);
  width:56px; height:56px; border:none; border-radius:12px; cursor:pointer;
  background:rgba(17,17,17,.35); color:#fff; font-size:22px; font-weight:800;
  display:flex; align-items:center; justify-content:center; opacity:.85;
  transition:opacity .2s ease, background .2s ease, transform .06s ease; z-index:5;
}
.arrow:hover{opacity:1; background:rgba(17,17,17,.55)}
.arrow:active{transform:translateY(-50%) scale(.96)}
.arrow-prev{left:24px} .arrow-next{right:24px}

/* Arrows are always visible except on narrow screens */
.slider .arrow{
  opacity: 1;
  pointer-events: auto;
  transition: opacity .2s ease;
  z-index: 5; /* поверх overlay/panel */
}

body.is-collapsed .slider .arrow{
  opacity: 1 !important;
  pointer-events: auto !important;
}
/* Allow overlap logic to hide arrows even when header is collapsed */
body.is-collapsed .slider .arrow.is-hidden{
  opacity: 0 !important;
  pointer-events: none !important;
}

/* Sections / footer */
.section{padding:72px 0; border-top:1px solid var(--line)}
.section-title{margin:0 0 24px; font-weight:800; font-size:28px}
.cards{display:grid; grid-template-columns:repeat(3,1fr); gap:18px}
.card{display:block; padding:20px; border:1px solid var(--line); border-radius:14px; text-decoration:none; color:inherit; transition:transform .2s ease, box-shadow .2s ease, border-color .2s ease}
.card:hover{transform:translateY(-2px); box-shadow:0 10px 24px rgba(0,0,0,.06); border-color:#dfe3e8}
.card h3{margin:0 0 6px; font-size:18px; font-weight:800}
.card p{margin:0; color:var(--muted)}

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  .slides{transition:none!important}
  .arrow{transition:none!important}
}
/* Base */
.menu-toggle{
  position: absolute;
  right: 16px;
  top: 50%;
  transform: translateY(-50%); /* center vertically */
  display: block;
  visibility: hidden;
  opacity: 0;
  transition:
    opacity .2s ease,
    visibility .2s ease,
    color .18s ease,
    background-color .18s ease,
    border-color .18s ease,
    transform .12s ease;
  white-space: nowrap;
  appearance: none;
  background: #fff;

  /* Keep border width constant to avoid layout jump on hover */
  border: 1px solid transparent;
  border-radius: 10px;

  padding: 8px 10px;
  cursor: pointer;
  font: inherit;
  font-weight: 600;
  color: #1f2937;
  flex: 0 0 auto;
}

/* Show when nav is hidden */
body.is-nav-hidden .menu-toggle{
  visibility: visible;
  opacity: 1;
}

/* Hover: move slightly UP, same as nav links */
.menu-toggle:hover{
  /* if your links move up by 2px, mirror that here */
  transform: translateY(calc(-50% - 2px));
  background-color: #f9fafb; /* match your link hover bg if any */
  border-color: #e5e7eb;     /* match your link hover border if any */
}

/* Active/pressed: a bit less lift than hover (like links) */
.menu-toggle:active{
  transform: translateY(calc(-50% - 1px));
}

/* Keyboard focus accessibility to match link focus style */
.menu-toggle:focus-visible{
  outline: 2px solid #2563eb; /* adjust to your theme */
  outline-offset: 2px;
}

/* animated underline bar (identical behavior to .main-nav a::after) */
.menu-toggle::after{
  content:"";
  position:absolute;
  left:50%;
  bottom:6px;
  width:60%;
  height:2px;
  background:var(--accent);
  border-radius:2px;
  opacity:.95;
  transform:translateX(-50%) scaleX(0);
  transform-origin:center;
  transition:transform .22s ease;
}

/* show underline on hover/focus, and keep it when menu is open */
.menu-toggle:hover::after,
.menu-toggle:focus-visible::after,
body.is-menu-open .menu-toggle::after{
  transform:translateX(-50%) scaleX(1);
}

/* ===== Offcanvas menu ===== */
.offcanvas{
  position:fixed; inset:0; z-index:120; pointer-events:none; opacity:0;
  transition:opacity .2s ease;
}
.offcanvas-backdrop{
  position:absolute; inset:0;
  background:transparent;
  opacity:0;
}
.offcanvas-panel{
  position:absolute; top:0; left:0; height:100%; width:min(360px, 90vw);
  background:#fff; border-right:1px solid var(--line);
  box-shadow: 18px 0 40px rgba(0,0,0,.18);
  transform:translateX(-100%); transition:transform .28s ease;
  display:flex; flex-direction:column;
}
.offcanvas-head{
  display:flex; align-items:center; justify-content:space-between;
  height:64px; padding:0 16px; border-bottom:1px solid var(--line);
}
.offcanvas-brand img{ height:32px; width:auto }
.offcanvas-close{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  height:40px;
  width:40px;
  border-radius:10px;
  border:1px solid var(--line);
  background:#fff;
  cursor:pointer;
  font-size:18px;
  font-weight:800;
  color:#1f2937;
  transition:transform .12s ease, border-color .18s ease, background .18s ease;
}

.offcanvas-close:hover,
.offcanvas-close:focus-visible{
  transform:translateY(-1px);
  border-color:#dfe3e8;
  background:#fafafa;
}

.offcanvas-nav{
  padding:14px; display:flex; flex-direction:column; gap:8px; overflow:auto;
}
.offcanvas-nav a{
  display:flex;                 /* use flexbox for centering */
  align-items:center;
  justify-content:center;       /* center text horizontally */
  padding:12px 14px;
  border:1px solid var(--line);
  border-radius:12px;
  text-decoration:none;
  color:#1f2937;

  font: inherit;                /* inherit same font as header links */
  font-weight:600;              /* match .main-nav a */
  text-align:center;
  white-space:nowrap;           /* prevent text wrapping */

  transition:transform .12s ease, border-color .18s ease, background .18s ease;
}
.offcanvas-nav a:hover{ transform:translateY(-1px); border-color:#dfe3e8; background:#fafafa }

/* Open state */
body.is-menu-open .offcanvas{ pointer-events:auto; opacity:1 }
body.is-menu-open .offcanvas-backdrop{ opacity:1 }
body.is-menu-open .offcanvas-panel{ transform:none }

/* Lock scroll when menu open */
body.is-menu-open{ overflow:hidden }

/* Prevent nav from shrinking/wrapping to avoid jank on resize */
.site-header .main-nav{
  display: flex;
  align-items: center;
  gap: 18px;
  margin-left: auto;
  transition: opacity .25s ease, visibility .25s ease;
  flex: 0 0 auto;       /* NEW: keep width stable (no flex-shrink) */
  white-space: nowrap;  /* NEW: prevent wrapping */
}
.site-header .main-nav a{
  padding: 8px 10px;
  border-radius: 10px;
  border: 1px solid transparent;
  text-decoration: none;
  color: #1f2937;
  font-weight: 600;
  position: relative;
  transition: color .18s ease, background-color .18s ease, transform .12s ease, border-color .18s ease;
  flex: 0 0 auto;       /* NEW: prevent individual link shrink */
}

/* Stack "What we do" cards vertically on narrow screens */
@media (max-width: 860px){
  .cards{
    display: grid;                 /* works whether you used grid or flex above */
    grid-template-columns: 1fr;    /* one column */
    gap: 16px;                     /* comfortable vertical spacing */
  }
  .cards .card{
    width: 100%;                   /* ensure full width */
  }
}

/* Global safety: never allow horizontal scrolling caused by tiny overshoots */
html, body{ overflow-x: clip; }

/* Hide an arrow when it visually overlaps the text frame */
.slider .arrow.is-hidden{
  opacity: 0;
  pointer-events: none;
  transition: opacity .2s ease;
}
/* Hide arrows on narrow screens where there's no room */
@media (max-width: 1024px){
  .slider .arrow{
    opacity: 0;
    pointer-events: none;
  }
  /* prepaint
  body:not(.js-ready) .slider .arrow{
    display: none !important;
  }
}